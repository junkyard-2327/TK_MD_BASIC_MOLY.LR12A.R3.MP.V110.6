/*****************************************************************************
*  Copyright Statement:
*  --------------------
*  This software is protected by Copyright and the information contained
*  herein is confidential. The software may not be copied and the information
*  contained herein may not be used or disclosed except with the written
*  permission of MediaTek Inc. (C) 2005
*
*  BY OPENING THIS FILE, BUYER HEREBY UNEQUIVOCALLY ACKNOWLEDGES AND AGREES
*  THAT THE SOFTWARE/FIRMWARE AND ITS DOCUMENTATIONS ("MEDIATEK SOFTWARE")
*  RECEIVED FROM MEDIATEK AND/OR ITS REPRESENTATIVES ARE PROVIDED TO BUYER ON
*  AN "AS-IS" BASIS ONLY. MEDIATEK EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES,
*  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
*  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NONINFRINGEMENT.
*  NEITHER DOES MEDIATEK PROVIDE ANY WARRANTY WHATSOEVER WITH RESPECT TO THE
*  SOFTWARE OF ANY THIRD PARTY WHICH MAY BE USED BY, INCORPORATED IN, OR
*  SUPPLIED WITH THE MEDIATEK SOFTWARE, AND BUYER AGREES TO LOOK ONLY TO SUCH
*  THIRD PARTY FOR ANY WARRANTY CLAIM RELATING THERETO. MEDIATEK SHALL ALSO
*  NOT BE RESPONSIBLE FOR ANY MEDIATEK SOFTWARE RELEASES MADE TO BUYER'S
*  SPECIFICATION OR TO CONFORM TO A PARTICULAR STANDARD OR OPEN FORUM.
*
*  BUYER'S SOLE AND EXCLUSIVE REMEDY AND MEDIATEK'S ENTIRE AND CUMULATIVE
*  LIABILITY WITH RESPECT TO THE MEDIATEK SOFTWARE RELEASED HEREUNDER WILL BE,
*  AT MEDIATEK'S OPTION, TO REVISE OR REPLACE THE MEDIATEK SOFTWARE AT ISSUE,
*  OR REFUND ANY SOFTWARE LICENSE FEES OR SERVICE CHARGE PAID BY BUYER TO
*  MEDIATEK FOR SUCH MEDIATEK SOFTWARE AT ISSUE. 
*
*  THE TRANSACTION CONTEMPLATED HEREUNDER SHALL BE CONSTRUED IN ACCORDANCE
*  WITH THE LAWS OF THE STATE OF CALIFORNIA, USA, EXCLUDING ITS CONFLICT OF
*  LAWS PRINCIPLES.  ANY DISPUTES, CONTROVERSIES OR CLAIMS ARISING THEREOF AND
*  RELATED THERETO SHALL BE SETTLED BY ARBITRATION IN SAN FRANCISCO, CA, UNDER
*  THE RULES OF THE INTERNATIONAL CHAMBER OF COMMERCE (ICC).
*
*****************************************************************************/

/*****************************************************************************
 *
 * Filename:
 * ---------
 * 
 *
 * Project:
 * --------
 *   MAUI
 *
 * Description:
 * ------------
 * 
 *
 * Author:
 * -------
 * 
 *
 *============================================================================
 *             HISTORY
 * Below this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *------------------------------------------------------------------------------
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 *
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 *------------------------------------------------------------------------------
 * Upper this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *============================================================================
 ****************************************************************************/

#include "kal_general_types.h"
#include "sbp_public_utility.h"
#include "kal_public_api.h"
#include "nvram_interface.h"
#include "nvram_data_items.h"
#include "nvram_enums.h"
#include "nvram_editor_data_item.h"

extern sim_interface_enum l4c_gemini_get_actual_sim_id(sim_interface_enum simId);


#ifdef __VOLTE_SUPPORT__

 /*****************************************************************************
  * FUNCTION
  *  nvram_custom_config_vdm_ads_profile
  * DESCRIPTION
  *  Pre-process nvram data items for VDM ADS PROFILE at customer function.
  *  User can pre-process nvram data items using NVRAM external API here.
  *  nvram_external_write_data()
  *  nvram_external_read_data()
  * PARAMETERS
  *  sbp_id
  *  is_in_dynamic_sbp (not used)
  *  imsi (not used)
  *  ps_id
  * RETURNS
  *  KAL_TRUE
  *****************************************************************************/
 kal_bool nvram_custom_config_vdm_ads_profile(sbp_reconfig_custom_param_struct *param_ptr)
 {
     kal_uint8* nvram_read_buf_ptr = NULL;
     kal_uint8 vdm_ims_reconfig_enable = 1;
     nvram_ef_vdm_nv_data_struct* nvram_vdm_nv_data_ptr = NULL;
     nvram_ef_vdm_ads_profile_struct* nvram_vdm_ads_profile_ptr = NULL;
     nvram_ef_vdm_ads_profile_struct* default_vdm_ads_profile_ptr = NULL;
  
     // Allocate buffer to read VDM_NV_DATA setting
     nvram_read_buf_ptr = (kal_uint8*)get_ctrl_buffer(sizeof(kal_uint8) * NVRAM_EF_VDM_NV_DATA_SIZE);
     nvram_vdm_nv_data_ptr = (nvram_ef_vdm_nv_data_struct*)nvram_read_buf_ptr;

     // read VDM ims_reconfig_enable setting first
     nvram_external_read_data(NVRAM_EF_VDM_NV_DATA_LID,
                             l4c_gemini_get_actual_sim_id((sim_interface_enum)param_ptr->ps_id)+1,
                             nvram_read_buf_ptr,
                             NVRAM_EF_VDM_NV_DATA_SIZE);
     vdm_ims_reconfig_enable = nvram_vdm_nv_data_ptr->ims_reconfig_enable;
     // Free allocated buffer
     if (nvram_read_buf_ptr != NULL)
     {
         free_ctrl_buffer(nvram_read_buf_ptr);
         nvram_read_buf_ptr = NULL;
     }

     //reconfig NVRAM settings for ims reconfig
     if (vdm_ims_reconfig_enable == 1)//ims reconfig is enabled
     {
         // Allocate buffer to read VDM_ADS_PROFILE setting
     nvram_read_buf_ptr = (kal_uint8*)get_ctrl_buffer(sizeof(kal_uint8) * NVRAM_EF_VDM_ADS_PROFILE_SIZE);
     nvram_vdm_ads_profile_ptr = (nvram_ef_vdm_ads_profile_struct*)nvram_read_buf_ptr;

     //set to default value
     if(NVRAM_DEFAULT_VALUE_POINT == nvram_get_default_value(NVRAM_EF_VDM_ADS_PROFILE_LID, l4c_gemini_get_actual_sim_id((sim_interface_enum)param_ptr->ps_id)+1,
                                          (kal_uint8**)&default_vdm_ads_profile_ptr))
     {
         kal_mem_cpy(nvram_vdm_ads_profile_ptr, default_vdm_ads_profile_ptr, sizeof(nvram_ef_vdm_ads_profile_struct));
     }
     else// Read current NVRAM setting
     {
         nvram_external_read_data(NVRAM_EF_VDM_ADS_PROFILE_LID,
                                 l4c_gemini_get_actual_sim_id((sim_interface_enum)param_ptr->ps_id)+1,
                                 nvram_read_buf_ptr,
                                 NVRAM_EF_VDM_ADS_PROFILE_SIZE);
     }

     //Store DSBP_ID
     if(param_ptr->is_in_dynamic_sbp == KAL_TRUE)
     {
        nvram_vdm_ads_profile_ptr->profile_common.dynamic_sbp_id = param_ptr->sbp_id;
     }

     switch (param_ptr->sbp_id)
     {
         case 1: /* CMCC */
         {
             //SBP_VDM_REDIAL_IMS_VT_TO_CS_VOICE
             nvram_vdm_ads_profile_ptr->profile_common.allow_vdm_redial_ims_vt_to_cs_voice = 1;
             nvram_vdm_ads_profile_ptr->profile_normal.need_check_emb_eutran_for_380_to_normal_cs = 1;

             break;
         }
         case 3: /* Orange */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             nvram_vdm_ads_profile_ptr->profile_emerg.prefer_cs_when_volte_unreged = 1;

             break;
         }
         case 5: /* TMOEU */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             // Disallow IMS emergency call while UE is roaming
             nvram_vdm_ads_profile_ptr->profile_emerg.reject_ims_emerg_while_roaming = 1;

             nvram_vdm_ads_profile_ptr->profile_normal.need_check_emb_eutran_for_380_to_normal_cs = 1;

             nvram_vdm_ads_profile_ptr->profile_normal.need_check_emb_eutran_for_380_normal_cs_to_ims = 1;
             
             // Disable Emergency call over WFC
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;

             // DTAG MTR-33031: To avoid AP don't send AT+ERDECCAPV VDM start 32s timer to decouple with AP.
             nvram_vdm_ads_profile_ptr->profile_normal.delay_leave_ap_mode_for_wfc_380_timer_length = 32;

             // Because User have 32s to decide whether leaving airplane mode, we increase the MO call guarded timer.
             nvram_vdm_ads_profile_ptr->profile_normal.general_setting_normal.ads_guard_timer_length = 40;

             break;
         }
         case 6: /* VDF */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             nvram_vdm_ads_profile_ptr->profile_emerg.ads_guard_ecc_cellular_search_timer_length = 10;

             nvram_vdm_ads_profile_ptr->profile_emerg.trigger_any_plmn_search_on_limited_srv_without_sib_emc_eutran = 1;

             // any plmn search rat mask, only search RAT_GSM_UMTS
             nvram_vdm_ads_profile_ptr->profile_emerg.any_plmn_search_rat_mode_mask_when_vowifi_available = 3;
             
             // Disable Emergency call over IMS and WFC at Greece and Romania
             if(((strcmp((char*)param_ptr->mcc, "202") == 0)&&(strcmp((char*)param_ptr->mnc, "05") == 0)) ||
                ((strcmp((char*)param_ptr->mcc, "226") == 0)&&(strcmp((char*)param_ptr->mnc, "01") == 0)))
             {
               nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;
               nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;
             }
             
             break;
         }
         case 7: /* AT&T */
         case 196: /*FirstNet*/         
         {
             // Disallow IMS emergency call with negative IMS voice over PS session indicator
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims_with_negative_imsvops_eutran = 0;

             // Disallow retry CS domain after IMS call attempt fail for normal call
             //nvram_vdm_ads_profile_ptr->profile_normal.general_setting_normal.allow_retry_cs_after_ims_fail = 0;

             nvram_vdm_ads_profile_ptr->profile_emerg.prefer_ims_in_lte_limited_srv = 0;

             nvram_vdm_ads_profile_ptr->profile_emerg.ads_guard_ecc_cellular_search_timer_length = 5;
            
             nvram_vdm_ads_profile_ptr->profile_common.is_access_barring_enable = 1;

             nvram_vdm_ads_profile_ptr->profile_common.prefer_cellular_for_short_code_call = 1; 

             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             //AT&T CDR-WiFi-1540, select WiFi if IMS is registered over WiFi even when UE is cellular prefer
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;
             
             // To re-scan network when there is no available cellular domain
             nvram_vdm_ads_profile_ptr->profile_emerg.rescan_network_when_no_available_cellular_domain = 1 ;

             break;
         }
         case 8: /* TMOUS */
         {
             // Disallow IMS emergency call with negative IMS voice over PS session indicator
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims_with_negative_imsvops_eutran = 0;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims_with_negative_imsvops_utran = 0;
 
             //SBP_VDM_REDIAL_IMS_VT_TO_CS_VOICE
             nvram_vdm_ads_profile_ptr->profile_common.allow_vdm_redial_ims_vt_to_cs_voice = 1;

             //SBP_VDM_REVERT_TO_CELLULAR_FOR_ECC
             nvram_vdm_ads_profile_ptr->profile_common.allow_revert_to_cellular_for_ecc = 1;

             //SBP_ECBM_ENABLE
             nvram_vdm_ads_profile_ptr->profile_common.is_ecbm_enable = 1;

             //SBP_ECBM_MODE_TIMER_SEC, SBP_ECBM_MODE_TIMER_MIN
             nvram_vdm_ads_profile_ptr->profile_common.ecbm_mode_timer_sec = 0;
             nvram_vdm_ads_profile_ptr->profile_common.ecbm_mode_timer_min = 3;

             //SBP_BEFORE_RINGING_CSFB
             nvram_vdm_ads_profile_ptr->profile_common.allow_before_ringing_csfb = 1;

             // Allow enable all RAT when there is no available domain
             nvram_vdm_ads_profile_ptr->profile_emerg.allow_enable_all_rat_when_no_available_domain = 1 ;

             // To re-scan network when there is no available cellular domain
             nvram_vdm_ads_profile_ptr->profile_emerg.rescan_network_when_no_available_cellular_domain = 1 ;

             break;
         }
         case 9: /* CT */
         {
             //allow_global_emc_scan
             nvram_vdm_ads_profile_ptr->profile_common.allow_global_emc_scan = 1;

             break;
         }
         case 11: /* H3G */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 12: /* VzW */
         {
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.max_attempt_total_num = 10;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.max_attempt_consecutive_ims_num = 5;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.max_attempt_consecutive_cs_num = 5;
			 
			 // __OP12_CDMA_LESS__
             nvram_vdm_ads_profile_ptr->profile_normal.allow_cs_during_ssac_barring = 0;
             nvram_vdm_ads_profile_ptr->profile_common.is_access_barring_enable = 1;

             //SBP_ECBM_ENABLE
             nvram_vdm_ads_profile_ptr->profile_common.is_ecbm_enable = 1;

             //allow_global_emc_scan
             nvram_vdm_ads_profile_ptr->profile_common.allow_global_emc_scan = 1;

             //SBP_ECBM_MODE_TIMER_SEC, SBP_ECBM_MODE_TIMER_MIN
             nvram_vdm_ads_profile_ptr->profile_common.ecbm_mode_timer_sec = 0;
             nvram_vdm_ads_profile_ptr->profile_common.ecbm_mode_timer_min = 5;
			 
			 // not allow retry CS domain after WFC fail
			 nvram_vdm_ads_profile_ptr->profile_normal.general_setting_normal.allow_retry_cs_after_wfc_fail = 0;

             break;
         }
         case 15: /* Telefonica */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 16: /* EE */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 17: /*DOCOMO*/
         {
             // Disallow CS during ssac barring
             nvram_vdm_ads_profile_ptr->profile_normal.allow_cs_during_ssac_barring = 0;

             // Disallow any PLMN search when connected OOS for ECC
             nvram_vdm_ads_profile_ptr->profile_emerg.allow_any_plmn_search_for_ecc = 0;

             /* SBP_VDM_CONVERT_ATD_TO_ATDE_FOR_ECC_CHECK
                         * Do not convert ATD to ATDE for ECC check result or it may cause empty emergency service category in CC SETUP */
             nvram_vdm_ads_profile_ptr->profile_common.allow_convert_atd_to_atde_for_ecc_check = 0;
             
             break;
         }
         case 18: /* RJIL */
         {
             // Cellular 5 + wifi 5 + CS 1
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.max_attempt_total_num = 11;

             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.max_attempt_consecutive_ims_num = 5;

             break;
         } 
         case 19: /* Telstra */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;
             
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.timer_length_delay_resume_ads_for_service_recover_from_23g = 5;

             /* To improve ECC performance for LTE only coverage, UE would not force select 2/3G for the first CS domain attempt.
              * Therefore we change below setting to let UE have chance to force select 2/3G after IMS ECC failed.
              */
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.max_attempt_consecutive_cs_num = 2;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_recursive_cs = 1;

             break;
         }
         case 20: /* Sprint */
         {
             //SBP_ECBM_ENABLE
             nvram_vdm_ads_profile_ptr->profile_common.is_ecbm_enable = 1;

             //allow_global_emc_scan
             nvram_vdm_ads_profile_ptr->profile_common.allow_global_emc_scan = 1;

             // TS107 TC3870 5 mins to search service
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.ads_guard_timer_length = 300;

             break;
         }
         case 50: /* Softbank */
         {
            nvram_vdm_ads_profile_ptr->profile_normal.allow_cs_during_ssac_barring = 0;

            // Disallow emergency call over IMS when volte switch off
            nvram_vdm_ads_profile_ptr->profile_emerg.allow_ims_with_volte_switch_off = 0;
            break;
         }
         case 107: /* SFR */
         {
             // Disallow emergency call over IMS
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;
 
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 108: /* TWN */
         {
             //TWM requirement: treat 110/119 as normal CS call w/ valid SIM (In case AP use ATD to Dial 110/119)
             nvram_vdm_ads_profile_ptr->profile_common.allow_special_ecc_as_normal_cs = 1;
             
             break;
         }
         case 109: /* CHT */
         {
             // treat 110/119 as normal CS call w/ valid SIM
             nvram_vdm_ads_profile_ptr->profile_common.allow_special_ecc_as_normal_cs = 1;

             break;
         }
         case 110: /* FET */
         {
             nvram_vdm_ads_profile_ptr->profile_emerg.prefer_cs_when_volte_unreged = 1;

             break;
         }
		 case 112: /* TelCel Mexico */
         {
			 if(((strcmp((char*)param_ptr->mcc, "334") == 0)&&(strcmp((char*)param_ptr->mnc, "02") == 0))||
                ((strcmp((char*)param_ptr->mcc, "334") == 0)&&(strcmp((char*)param_ptr->mnc, "020") == 0)))
             {
				 //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
				 nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;
			 }
             break;
         }
         case 113: /* Beeline-Russia */
         {
             //Disabled allow_ims for emergency call
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;

             //Disallow WFC emergency call
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;
             
             break;
         }
         case 114: /* KT */
         {
			 //TTA request dial ECC over WCDMA when UE in limited service
             nvram_vdm_ads_profile_ptr->profile_emerg.prefer_ims_in_lte_limited_srv = 0;

			 //TTA request dial ECC over WCDMA when UE don't register to IMS
			 nvram_vdm_ads_profile_ptr->profile_emerg.prefer_cs_when_volte_unreged = 1;

             break;
         }
		 case 115: /* SKT */
         {
			 //TTA ask dial ECC over WCDMA when UE in limited service
             nvram_vdm_ads_profile_ptr->profile_emerg.prefer_ims_in_lte_limited_srv = 0;

			 //TTA request dial ECC over WCDMA when UE don't register to IMS
			 nvram_vdm_ads_profile_ptr->profile_emerg.prefer_cs_when_volte_unreged = 1;

             break;
         }
		 case 116: /* LG U+ */
         {
			 //TTA ask dial ECC over WCDMA when UE in limited service
             nvram_vdm_ads_profile_ptr->profile_emerg.prefer_ims_in_lte_limited_srv = 0;

			 //TTA request dial ECC over WCDMA when UE don't register to IMS
			 nvram_vdm_ads_profile_ptr->profile_emerg.prefer_cs_when_volte_unreged = 1;

             break;
         }
         case 117: /* Smartfren */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             //only allow UE attempt normal call on CS domain whe UE is roaming
             nvram_vdm_ads_profile_ptr->profile_normal.general_setting_normal.allow_cs = 3;
             break;
         }
         case 120: /* Claro */
         {
            if(((strcmp((char*)param_ptr->mcc, "748") == 0)&&(strcmp((char*)param_ptr->mnc, "10") == 0))||
                ((strcmp((char*)param_ptr->mcc, "748") == 0)&&(strcmp((char*)param_ptr->mnc, "010") == 0)))   // Claro/Uruguay
             {
                // Disallow WFC emergency call
                nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;
             }
            
            if((strcmp((char*)param_ptr->mcc, "730") == 0)&&(strcmp((char*)param_ptr->mnc, "03") == 0))       // Claro/Chile
             {
                 //Disabled allow_ims for emergency call
                 nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;

                 //Disallow WFC emergency call
                 nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;                 
             }
            
            break;
         }
         case 121: /* Bell */
         {
             // Bell_v170_54597 request 3s, but operator allow us to increase search timer.
             nvram_vdm_ads_profile_ptr->profile_emerg.ads_guard_ecc_cellular_search_timer_length = 10;
             
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;
             
             nvram_vdm_ads_profile_ptr->profile_emerg.prefer_cs_when_volte_unreged = 1;
             
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.timer_length_delay_resume_ads_for_service_recover_from_23g = 5;

             /* To improve ECC performance for LTE only coverage, UE would not force select 2/3G for the first CS domain attempt.
              * Therefore we change below setting to let UE have chance to force select 2/3G after IMS ECC failed.
              */
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.max_attempt_consecutive_cs_num = 2;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_recursive_cs = 1;
             
             break;
         }
         case 122: /* AIS */
         {
             //SBP_VDM_DISABLE_RETRY_WHEN_VOWIFI_GOT_NW_REJECT
             nvram_vdm_ads_profile_ptr->profile_common.disable_retry_when_vowifi_got_nw_reject = 1;
             break;
         }
         case 124: /* APTG */
         {
            // Disallow WFC emergency call
            nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;
            nvram_vdm_ads_profile_ptr->profile_emerg.prefer_ims_in_lte_limited_srv = 0;
            break;
         }
         case 126: /* TurkTelekom/Turkey */
         {
            // Disallow IMS emergency call while UE is roaming
            nvram_vdm_ads_profile_ptr->profile_emerg.reject_ims_emerg_while_roaming = 1;

            nvram_vdm_ads_profile_ptr->profile_emerg.prefer_ims_in_lte_limited_srv = 0;
            
            break;
         }
         case 127: /* Megafon */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 128: /* DNA */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 129: /* KDDI */
         {
             // Allow UE to attempt IMS ECC although SIB1 don't have ims-emergencyservice
             nvram_vdm_ads_profile_ptr->profile_emerg.allow_ims_with_negative_sib_emc_eutran = 1;
             
             // Disallow IMS emergency call while UE is roaming
             nvram_vdm_ads_profile_ptr->profile_emerg.reject_ims_emerg_while_roaming = 1;

             break;
         }
         case 132: /* Movistar */
         {
             if(((strcmp((char*)param_ptr->mcc, "722") == 0)&&(strcmp((char*)param_ptr->mnc, "07") == 0))||
                 ((strcmp((char*)param_ptr->mcc, "732") == 0)&&(strcmp((char*)param_ptr->mnc, "123") == 0))||
                 ((strcmp((char*)param_ptr->mcc, "740") == 0)&&(strcmp((char*)param_ptr->mnc, "00") == 0))||
                 ((strcmp((char*)param_ptr->mcc, "334") == 0)&&(strcmp((char*)param_ptr->mnc, "030") == 0))
                )
             {
                //Disabled allow_ims for emergency call
                nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;

                //Disallow WFC emergency call
                nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;
             }

             break;
         }
         case 134: /* Elisa */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 135: /* MTS */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 137: /* Tele2 */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;
             
             if((strcmp((char*)param_ptr->mcc, "240") == 0)&&(strcmp((char*)param_ptr->mnc, "07") == 0))  // Tele2-Sweden
             {
				 //Disallow WFC emergency call
                 nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;
			 }

             break;
         }
         case 139: /* Bouygues */
         {
             // Disallow emergency call over IMS
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;

             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

            break;
         }
         case 140: /* MTN */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 141: /* CellC */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 143: /* TurkCell */
         {
            // Disallow emergency call over IMS
            nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;

             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

            break;
         }
         case 145: /* Cricket */
         {
             // Disallow IMS emergency call with negative IMS voice over PS session indicator
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims_with_negative_imsvops_eutran = 0;
             // Disallow retry CS domain after IMS call attempt fail for normal call
             //nvram_vdm_ads_profile_ptr->profile_normal.general_setting_normal.allow_retry_cs_after_ims_fail = 0;

             #ifdef __MULTIPLE_IMS_SUPPORT__
             nvram_vdm_ads_profile_ptr->profile_common.is_access_barring_enable = 1;
             #endif

             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;
             
             // ATT <CDR-LTE-2490> WPS call fail retry CSFB not apply to Cricket
             nvram_vdm_ads_profile_ptr->profile_normal.allow_retry_cs_after_wps_volte_fail = 0;

             break;
         }
         case 146: /* Etisalat */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 150: /* Swisscom */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 153: /* VHA Australia */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 154: /* Telia */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             //For Lithuania need to disable IMS emergency call.
             if(strcmp((char*)param_ptr->mcc, "246") == 0)
                {
                // Disallow IMS emergency call
                nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;
                }
                
             break;
         }
         case 155: /* Digi */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             //For Hungary need to disable emergency call over IMS while roaming.
             if(strcmp((char*)param_ptr->mcc, "216") == 0)
                {
                // Disallow IMS emergency call while UE is roaming
                nvram_vdm_ads_profile_ptr->profile_emerg.reject_ims_emerg_while_roaming = 1;
                // Disallow WFC emergency call
                nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;
                }

             //For Romania need to disable WFC emergency call.
             if(strcmp((char*)param_ptr->mcc, "226") == 0)
                {
                // Disallow WFC emergency call
                nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;
                }

             break;
         }
         case 156: /* Telenor */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 157: /* TELUS in Canada */
         {
             /* [TELUS-Feb2017_VOLTE-247]
              *   The UE SHALL use CS Fallback (CSFB) for emergency call while camped on E-UTRAN
              *   having non-VoLTE TAC since UE SHALL NOT include the 'MMTel' feature tag when 
              *   attempting to register to IMS while camped on non-VoLTE TAC.
              *   related TC: VoLTE-TC-79, 90, 96, 97, 99, 100, 101, 102
              *   
              *   [Jerry] according to Kuan-wei, non-VoLTE TAC means VoPS = 0. Which result in IMS would not rigstered.
              *      The key here is the test cases indicate that:
              *      (Mandatory) UE SHALL be able to establish a CSFB emergency call with 
              *      PSAP dialable callback number while IMS registration fails.
              *
              * [TELUS-Feb2017_VOLTE-248]
              *   The UE SHALL use CS Fallback (CSFB) for emergency call while camped on E-UTRAN of VPLMN during roaming.
              */
             nvram_vdm_ads_profile_ptr->profile_emerg.prefer_cs_when_volte_unreged = 1;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.prefer_cs_when_lte_roaming = 1;

             /* VoLTE-TC-89, workaround 
             ** if call fails in 23G (LTE only coverage), NWSEL will search back to LTE automarically, VDM won't have to trigger ANY PLMN search to interrupt it immediately
             */             
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.timer_length_delay_resume_ads_for_service_recover_from_23g = 5;

             /* To improve ECC performance for LTE only coverage, UE would not force select 2/3G for the first CS domain attempt.
              * Therefore we change below setting to let UE have chance to force select 2/3G after IMS ECC failed.
              */
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.max_attempt_consecutive_cs_num = 2;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_recursive_cs = 1;

             break;
         }
         case 158: /* Zain */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 161: /* Play */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             // disable retry for vowifi connection setup fail
             nvram_vdm_ads_profile_ptr->profile_common.disable_retry_for_vowifi_connection_setup_fail = 1;

             break;
         }
         case 162: /* Freedom - Canada */
         {
             nvram_vdm_ads_profile_ptr->profile_emerg.prefer_cs_when_volte_unreged = 1;
             
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.timer_length_delay_resume_ads_for_service_recover_from_23g = 5;

             /* To improve ECC performance for LTE only coverage, UE would not force select 2/3G for the first CS domain attempt.
              * Therefore we change below setting to let UE have chance to force select 2/3G after IMS ECC failed.
              */
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.max_attempt_consecutive_cs_num = 2;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_recursive_cs = 1;
             break;
         }
         case 165: /* Sunrise */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 175: /* TDC */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 176: /* T-star */
         {
            // Disallow emergency call over IMS
            nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;

            // also treat dial 110/119 as normal cs
            nvram_vdm_ads_profile_ptr->profile_common.allow_special_ecc_as_normal_cs = 1;
            break;
         }
         case 179: /* Newroz */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 181: /* Telkom South-Africa */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 182: /* Proximus */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 183: /* Personal Argentina */
         {
             // Disallow WFC emergency call
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;

             break;
         }
         case 188: /* A1 */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;
             
             // Disallow emergency call over VoLTE and WFC at Croatia
             if(strcmp((char*)param_ptr->mcc, "219") == 0)
             {
                 nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;
                 nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;
             }

             break;
         }
         case 199: /* Vivacom Bulgaria */
         {
             // Disallow WFC emergency call
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;

             break;
         }
         case 203: /* NOS */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 206: /* SKY */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 214: /* IDC */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }		 
         case 217: /*Telekom-Slovenia*/
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 221: /* TPG-Singapore */
         {
             //Check WiFi first if IMS registered over WiFi in Cellular Preferred mode
             nvram_vdm_ads_profile_ptr->profile_common.ads_cellular_prefer_check_vowifi_first_if_ims_reg_on_wifi = 1;

             break;
         }
         case 235: /* VIP */
         {
             // Disallow emergency call over VoLTE and WFC at Macedonia and Serbia
             if((strcmp((char*)param_ptr->mcc, "294") == 0) ||
                (strcmp((char*)param_ptr->mcc, "220") == 0))
             {
                 nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;
                 nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;
             }
             
             break;
         }
         case 277: /* Telemach Slovenia */
         {
             // Disallow emergency call over VoLTE and WFC
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;

             break;
         }
         case 243: /* Globe-Philippine */
         {
             // Disallow WFC emergency call
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;

             break;
         }
         case 236: /*USCC*/
         {
             //allow_global_emc_scan
             nvram_vdm_ads_profile_ptr->profile_common.allow_global_emc_scan = 1;
             
             //SBP_ECBM_ENABLE
             nvram_vdm_ads_profile_ptr->profile_common.is_ecbm_enable = 1;

             break;
         }
         case 281: /* Kyivstar/Ukraine */
         {
             // Disallow emergency call over VoLTE and WFC
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;

             break;
         }
         case 283: /* MEO/Portugal */
         {
             // Disallow emergency call over VoLTE and WFC
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_ims = 0;
             nvram_vdm_ads_profile_ptr->profile_emerg.general_setting_emerg.allow_wfc = 0;

             break;
         }
         default:
             break;
     }
 
     nvram_external_write_data(NVRAM_EF_VDM_ADS_PROFILE_LID,
                               l4c_gemini_get_actual_sim_id((sim_interface_enum)param_ptr->ps_id)+1,
                               nvram_read_buf_ptr,
                               NVRAM_EF_VDM_ADS_PROFILE_SIZE);
 
     // Free allocated buffer
     if (nvram_read_buf_ptr != NULL)
     {
         free_ctrl_buffer(nvram_read_buf_ptr);
         nvram_read_buf_ptr = NULL;
     }
     }
     return KAL_TRUE;
 }

/*****************************************************************************
 * FUNCTION
 *  nvram_custom_reset_vdm_ads_profile
 *
 * DESCRIPTION
 *  This function will reset nvram parameters to the default value for NVRAM_EF_VDM_ADS_PROFILE_LID.
 *
 * PARAMETERS
 *   old_sbp_id   previously SBP ID which is used to change the configuration of NVRAM_EF_VDM_ADS_PROFILE_LID
 *
 * RETURNS
 *  none
 *
 *****************************************************************************/
void nvram_custom_reset_vdm_ads_profile(kal_uint32 old_sbp_id, protocol_id_enum ps_id)
{
    kal_uint8* nvram_write_buf_ptr = NULL;
    nvram_ef_vdm_nv_data_struct* nvram_vdm_nv_data_ptr = NULL;
    kal_uint16 i;

    if (NVRAM_DEFAULT_VALUE_POINT == nvram_get_default_value(NVRAM_EF_VDM_ADS_PROFILE_LID,
            1,
            &nvram_write_buf_ptr))
    {
        nvram_external_write_data(NVRAM_EF_VDM_ADS_PROFILE_LID,
                1,
                nvram_write_buf_ptr,
                NVRAM_EF_VDM_ADS_PROFILE_SIZE);
    }

    // Allocate buffer to read NVRAM setting
    nvram_vdm_nv_data_ptr = (nvram_ef_vdm_nv_data_struct*)get_ctrl_buffer(sizeof(kal_uint8) * NVRAM_EF_VDM_NV_DATA_SIZE);

    //Reset pco5_radio_control_status=0
    for (i=1;i<=NVRAM_DUAL_RECORD;i++)
    {
        // Read current NVRAM setting
        nvram_external_read_data(NVRAM_EF_VDM_NV_DATA_LID,
                                 i,
                                 (kal_uint8*)nvram_vdm_nv_data_ptr,
                                 NVRAM_EF_VDM_NV_DATA_SIZE);
        nvram_vdm_nv_data_ptr->pco5_radio_control_status = 0;
        nvram_external_write_data(NVRAM_EF_VDM_NV_DATA_LID,
                                  i,
                                  (kal_uint8*)nvram_vdm_nv_data_ptr,
                                  NVRAM_EF_VDM_NV_DATA_SIZE);
    }
    
    return;
}

#endif /* __VOLTE_SUPPORT__ */



